<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chromeæµè§ˆå™¨è¯Šæ–­ - FatePath</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #fbbf24;
            margin-bottom: 10px;
        }
        .debug-section {
            background: #2a2a2a;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            border-left: 4px solid #fbbf24;
        }
        .debug-section h3 {
            color: #fbbf24;
            margin-top: 0;
        }
        .status {
            padding: 8px 12px;
            border-radius: 4px;
            margin: 5px 0;
            font-weight: 500;
        }
        .status.success { background: #065f46; color: #d1fae5; }
        .status.warning { background: #92400e; color: #fef3c7; }
        .status.error { background: #991b1b; color: #fee2e2; }
        .status.info { background: #1e40af; color: #dbeafe; }
        .button {
            background: #fbbf24;
            color: #1a1a1a;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 14px;
        }
        .button:hover {
            background: #f59e0b;
        }
        .log {
            background: #000;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .chrome-info {
            background: #1e40af;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .test-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .test-card {
            background: #374151;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #4b5563;
        }
        .test-card h4 {
            color: #fbbf24;
            margin-top: 0;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” Chromeæµè§ˆå™¨ç™½å±é—®é¢˜è¯Šæ–­</h1>
            <p>ä¸“é—¨ç”¨äºè¯Šæ–­Chromeæµè§ˆå™¨ç™½å±é—®é¢˜ï¼Œå¯¹æ¯”Safariæ­£å¸¸å·¥ä½œçš„åŸå› </p>
        </div>

        <div class="debug-section">
            <h3>ğŸŒ Chromeæµè§ˆå™¨ä¿¡æ¯</h3>
            <div id="chrome-info"></div>
        </div>

        <div class="debug-section">
            <h3>ğŸ”§ Chromeç‰¹å®šåŠŸèƒ½æ£€æµ‹</h3>
            <div id="chrome-features"></div>
        </div>

        <div class="debug-section">
            <h3>ğŸ“± è®¾å¤‡ä¸æµè§ˆå™¨å¯¹æ¯”</h3>
            <div id="browser-comparison"></div>
        </div>

        <div class="debug-section">
            <h3>ğŸ§ª Chromeç‰¹å®šæµ‹è¯•</h3>
            <div class="test-results">
                <div class="test-card">
                    <h4>ReactåŠ è½½æµ‹è¯•</h4>
                    <button class="button" onclick="testReactInChrome()">æµ‹è¯•React</button>
                    <div id="react-test-result"></div>
                </div>
                <div class="test-card">
                    <h4>æ¨¡å—åŠ è½½æµ‹è¯•</h4>
                    <button class="button" onclick="testModuleLoading()">æµ‹è¯•æ¨¡å—</button>
                    <div id="module-test-result"></div>
                </div>
                <div class="test-card">
                    <h4>ES6ç‰¹æ€§æµ‹è¯•</h4>
                    <button class="button" onclick="testES6Features()">æµ‹è¯•ES6</button>
                    <div id="es6-test-result"></div>
                </div>
                <div class="test-card">
                    <h4>Chromeæ‰©å±•æ£€æµ‹</h4>
                    <button class="button" onclick="detectChromeExtensions()">æ£€æµ‹æ‰©å±•</button>
                    <div id="extension-test-result"></div>
                </div>
            </div>
        </div>

        <div class="debug-section">
            <h3>ğŸ” é—®é¢˜è¯Šæ–­</h3>
            <button class="button" onclick="runFullChromeDiagnostic()">è¿è¡Œå®Œæ•´è¯Šæ–­</button>
            <button class="button" onclick="clearChromeLog()">æ¸…é™¤æ—¥å¿—</button>
            <div id="chrome-diagnostic-log" class="log"></div>
        </div>

        <div class="debug-section">
            <h3>ğŸ’¡ Chromeé—®é¢˜è§£å†³æ–¹æ¡ˆ</h3>
            <div id="chrome-solutions"></div>
        </div>
    </div>

    <script>
        // Chromeè¯Šæ–­æ—¥å¿—ç³»ç»Ÿ
        function logChrome(message, type = 'info') {
            const logElement = document.getElementById('chrome-diagnostic-log');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}\n`;
            logElement.textContent += logEntry;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(`[CHROME ${type.toUpperCase()}] ${message}`);
        }

        function clearChromeLog() {
            document.getElementById('chrome-diagnostic-log').textContent = '';
            logChrome('Chromeè¯Šæ–­æ—¥å¿—å·²æ¸…é™¤');
        }

        // Chromeæµè§ˆå™¨ä¿¡æ¯æ£€æµ‹
        function detectChromeInfo() {
            const chromeInfo = document.getElementById('chrome-info');
            const userAgent = navigator.userAgent;
            const isChrome = /Chrome/.test(userAgent) && !/Edge/.test(userAgent);
            const chromeVersion = userAgent.match(/Chrome\/(\d+)/);
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);
            
            if (isChrome) {
                chromeInfo.innerHTML = `
                    <div class="status success">
                        ğŸŒ æ£€æµ‹åˆ°Chromeæµè§ˆå™¨
                    </div>
                    <div class="status info">
                        ğŸ“± è®¾å¤‡ç±»å‹: ${isMobile ? 'ç§»åŠ¨è®¾å¤‡' : 'æ¡Œé¢è®¾å¤‡'}
                    </div>
                    <div class="status info">
                        ğŸ”¢ Chromeç‰ˆæœ¬: ${chromeVersion ? chromeVersion[1] : 'æœªçŸ¥'}
                    </div>
                    <div class="status info">
                        ğŸŒ User Agent: ${userAgent.substring(0, 100)}...
                    </div>
                `;
                logChrome(`Chromeä¿¡æ¯æ£€æµ‹å®Œæˆ - ç‰ˆæœ¬: ${chromeVersion ? chromeVersion[1] : 'æœªçŸ¥'}, ç§»åŠ¨ç«¯: ${isMobile}`);
            } else {
                chromeInfo.innerHTML = `
                    <div class="status error">
                        âŒ å½“å‰ä¸æ˜¯Chromeæµè§ˆå™¨
                    </div>
                    <div class="status info">
                        ğŸŒ å½“å‰æµè§ˆå™¨: ${userAgent}
                    </div>
                `;
                logChrome('å½“å‰ä¸æ˜¯Chromeæµè§ˆå™¨ï¼Œæ— æ³•è¿›è¡ŒChromeç‰¹å®šè¯Šæ–­');
            }
        }

        // Chromeç‰¹å®šåŠŸèƒ½æ£€æµ‹
        function detectChromeFeatures() {
            const chromeFeatures = document.getElementById('chrome-features');
            const features = {
                'requestIdleCallback': 'requestIdleCallback' in window,
                'IntersectionObserver': 'IntersectionObserver' in window,
                'ResizeObserver': 'ResizeObserver' in window,
                'PerformanceObserver': 'PerformanceObserver' in window,
                'WebGL': 'WebGLRenderingContext' in window,
                'ServiceWorker': 'serviceWorker' in navigator,
                'PushManager': 'PushManager' in window,
                'Notification': 'Notification' in window,
                'localStorage': 'localStorage' in window,
                'sessionStorage': 'sessionStorage' in window,
                'IndexedDB': 'indexedDB' in window,
                'WebAssembly': 'WebAssembly' in window
            };

            let featuresHTML = '';
            Object.entries(features).forEach(([feature, supported]) => {
                featuresHTML += `
                    <div class="status ${supported ? 'success' : 'error'}">
                        ${supported ? 'âœ…' : 'âŒ'} ${feature}: ${supported ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ'}
                    </div>
                `;
            });

            chromeFeatures.innerHTML = featuresHTML;
            logChrome('ChromeåŠŸèƒ½æ£€æµ‹å®Œæˆ');
        }

        // æµè§ˆå™¨å¯¹æ¯”
        function compareBrowsers() {
            const comparison = document.getElementById('browser-comparison');
            const userAgent = navigator.userAgent;
            const isSafari = /Safari/.test(userAgent) && !/Chrome/.test(userAgent);
            const isChrome = /Chrome/.test(userAgent) && !/Edge/.test(userAgent);
            
            comparison.innerHTML = `
                <div class="status ${isSafari ? 'success' : 'info'}">
                    ğŸ Safari: ${isSafari ? 'å½“å‰æµè§ˆå™¨' : 'å…¶ä»–æµè§ˆå™¨'}
                </div>
                <div class="status ${isChrome ? 'success' : 'info'}">
                    ğŸŒ Chrome: ${isChrome ? 'å½“å‰æµè§ˆå™¨' : 'å…¶ä»–æµè§ˆå™¨'}
                </div>
                <div class="status info">
                    ğŸ” å…³é”®å·®å¼‚åˆ†æ:
                </div>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li>Safariä½¿ç”¨WebKitå¼•æ“ï¼Œå¯¹æŸäº›JavaScriptç‰¹æ€§æ”¯æŒæœ‰é™</li>
                    <li>Chromeä½¿ç”¨Blinkå¼•æ“ï¼Œæ”¯æŒæ›´å¤šç°ä»£Webç‰¹æ€§</li>
                    <li>Chromeå¯èƒ½å¯¹ES6æ¨¡å—åŠ è½½æ›´ä¸¥æ ¼</li>
                    <li>Safariçš„ç¼“å­˜æœºåˆ¶å¯èƒ½æ›´å®½æ¾</li>
                </ul>
            `;
        }

        // æµ‹è¯•Reactåœ¨Chromeä¸­çš„åŠ è½½
        function testReactInChrome() {
            const resultDiv = document.getElementById('react-test-result');
            logChrome('ğŸ§ª å¼€å§‹æµ‹è¯•Reactåœ¨Chromeä¸­çš„åŠ è½½...');
            
            // æµ‹è¯•Reactç›¸å…³åŠŸèƒ½
            const tests = {
                'Reactå…¨å±€å¯¹è±¡': typeof React !== 'undefined',
                'ReactDOMå…¨å±€å¯¹è±¡': typeof ReactDOM !== 'undefined',
                'JSXæ”¯æŒ': true, // å‡è®¾æ”¯æŒ
                'ES6æ¨¡å—': typeof import !== 'undefined',
                'åŠ¨æ€å¯¼å…¥': typeof import === 'function'
            };

            let resultHTML = '';
            Object.entries(tests).forEach(([test, passed]) => {
                resultHTML += `
                    <div class="status ${passed ? 'success' : 'error'}">
                        ${passed ? 'âœ…' : 'âŒ'} ${test}
                    </div>
                `;
            });

            resultDiv.innerHTML = resultHTML;
            logChrome('Reactæµ‹è¯•å®Œæˆ');
        }

        // æµ‹è¯•æ¨¡å—åŠ è½½
        function testModuleLoading() {
            const resultDiv = document.getElementById('module-test-result');
            logChrome('ğŸ§ª å¼€å§‹æµ‹è¯•æ¨¡å—åŠ è½½...');
            
            // å°è¯•åŠ¨æ€å¯¼å…¥ä¸€ä¸ªç®€å•çš„æ¨¡å—
            try {
                // æµ‹è¯•ES6æ¨¡å—è¯­æ³•
                const testModule = `
                    export const test = 'module test';
                    export default function() { return 'default export'; }
                `;
                
                // åˆ›å»ºBlob URLæ¥æµ‹è¯•æ¨¡å—
                const blob = new Blob([testModule], { type: 'application/javascript' });
                const url = URL.createObjectURL(blob);
                
                resultDiv.innerHTML = `
                    <div class="status success">âœ… ES6æ¨¡å—è¯­æ³•æ”¯æŒ</div>
                    <div class="status success">âœ… Blob URLåˆ›å»ºæˆåŠŸ</div>
                    <div class="status info">æ¨¡å—URL: ${url.substring(0, 50)}...</div>
                `;
                
                // æ¸…ç†
                setTimeout(() => URL.revokeObjectURL(url), 1000);
                
                logChrome('æ¨¡å—åŠ è½½æµ‹è¯•å®Œæˆ');
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="status error">âŒ æ¨¡å—æµ‹è¯•å¤±è´¥: ${error.message}</div>
                `;
                logChrome(`æ¨¡å—æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        // æµ‹è¯•ES6ç‰¹æ€§
        function testES6Features() {
            const resultDiv = document.getElementById('es6-test-result');
            logChrome('ğŸ§ª å¼€å§‹æµ‹è¯•ES6ç‰¹æ€§...');
            
            const features = {
                'ç®­å¤´å‡½æ•°': () => true,
                'æ¨¡æ¿å­—ç¬¦ä¸²': `æµ‹è¯•${'æˆåŠŸ'}`,
                'è§£æ„èµ‹å€¼': (() => { const {a} = {a: 1}; return a === 1; })(),
                'é»˜è®¤å‚æ•°': (() => { function test(a = 1) { return a; } return test() === 1; })(),
                'å±•å¼€è¿ç®—ç¬¦': (() => { const arr = [...[1,2,3]]; return arr.length === 3; })(),
                'Promise': typeof Promise !== 'undefined',
                'async/await': (() => { try { eval('async function test() {}'); return true; } catch(e) { return false; } })()
            };

            let resultHTML = '';
            Object.entries(features).forEach(([feature, test]) => {
                const passed = typeof test === 'function' ? test() : test;
                resultHTML += `
                    <div class="status ${passed ? 'success' : 'error'}">
                        ${passed ? 'âœ…' : 'âŒ'} ${feature}
                    </div>
                `;
            });

            resultDiv.innerHTML = resultHTML;
            logChrome('ES6ç‰¹æ€§æµ‹è¯•å®Œæˆ');
        }

        // æ£€æµ‹Chromeæ‰©å±•
        function detectChromeExtensions() {
            const resultDiv = document.getElementById('extension-test-result');
            logChrome('ğŸ§ª å¼€å§‹æ£€æµ‹Chromeæ‰©å±•...');
            
            // æ£€æµ‹å¸¸è§çš„å¯èƒ½å¹²æ‰°é¡µé¢çš„æ‰©å±•
            const extensions = {
                'AdBlock': typeof window.adblock !== 'undefined',
                'uBlock Origin': typeof window.uBlock !== 'undefined',
                'NoScript': typeof window.noscript !== 'undefined',
                'Privacy Badger': typeof window.privacyBadger !== 'undefined',
                'Ghostery': typeof window.ghostery !== 'undefined'
            };

            let resultHTML = '';
            let hasExtensions = false;
            
            Object.entries(extensions).forEach(([ext, detected]) => {
                if (detected) {
                    hasExtensions = true;
                    resultHTML += `
                        <div class="status warning">
                            âš ï¸ æ£€æµ‹åˆ°æ‰©å±•: ${ext}
                        </div>
                    `;
                }
            });

            if (!hasExtensions) {
                resultHTML = `
                    <div class="status success">âœ… æœªæ£€æµ‹åˆ°å¹²æ‰°æ€§æ‰©å±•</div>
                `;
            }

            resultDiv.innerHTML = resultHTML;
            logChrome('Chromeæ‰©å±•æ£€æµ‹å®Œæˆ');
        }

        // è¿è¡Œå®Œæ•´Chromeè¯Šæ–­
        function runFullChromeDiagnostic() {
            logChrome('ğŸš€ å¼€å§‹è¿è¡Œå®Œæ•´Chromeè¯Šæ–­...');
            
            // æ£€æµ‹Chromeç‰ˆæœ¬é—®é¢˜
            const userAgent = navigator.userAgent;
            const chromeVersion = userAgent.match(/Chrome\/(\d+)/);
            
            if (chromeVersion) {
                const version = parseInt(chromeVersion[1]);
                logChrome(`Chromeç‰ˆæœ¬: ${version}`);
                
                if (version < 80) {
                    logChrome('âš ï¸ Chromeç‰ˆæœ¬è¿‡ä½ï¼Œå¯èƒ½ä¸æ”¯æŒæŸäº›ES6ç‰¹æ€§', 'warning');
                } else if (version < 90) {
                    logChrome('âš ï¸ Chromeç‰ˆæœ¬è¾ƒæ—§ï¼ŒæŸäº›ç°ä»£ç‰¹æ€§å¯èƒ½å—é™', 'warning');
                } else {
                    logChrome('âœ… Chromeç‰ˆæœ¬è¾ƒæ–°ï¼Œåº”è¯¥æ”¯æŒæ‰€æœ‰ç°ä»£ç‰¹æ€§');
                }
            }

            // æ£€æµ‹å¯èƒ½çš„å†²çª
            setTimeout(() => {
                const root = document.getElementById('root');
                if (root && root.children.length === 0) {
                    logChrome('âŒ æ£€æµ‹åˆ°é¡µé¢ä»ç„¶ä¸ºç©ºï¼Œå¯èƒ½å­˜åœ¨Chromeç‰¹å®šé—®é¢˜', 'error');
                    
                    // æ£€æŸ¥æ§åˆ¶å°é”™è¯¯
                    const originalError = console.error;
                    console.error = function(...args) {
                        logChrome(`ğŸš¨ æ§åˆ¶å°é”™è¯¯: ${args.join(' ')}`, 'error');
                        originalError.apply(console, args);
                    };
                } else {
                    logChrome('âœ… é¡µé¢å†…å®¹æ­£å¸¸åŠ è½½');
                }
            }, 2000);

            // æ£€æŸ¥ç½‘ç»œè¯·æ±‚
            if ('fetch' in window) {
                fetch('/src/main.jsx')
                    .then(response => {
                        if (response.ok) {
                            logChrome('âœ… main.jsx ç½‘ç»œè¯·æ±‚æˆåŠŸ');
                        } else {
                            logChrome(`âŒ main.jsx ç½‘ç»œè¯·æ±‚å¤±è´¥: ${response.status}`, 'error');
                        }
                    })
                    .catch(error => {
                        logChrome(`âŒ main.jsx ç½‘ç»œè¯·æ±‚å¼‚å¸¸: ${error.message}`, 'error');
                    });
            }
        }

        // æ˜¾ç¤ºChromeé—®é¢˜è§£å†³æ–¹æ¡ˆ
        function showChromeSolutions() {
            const solutionsDiv = document.getElementById('chrome-solutions');
            solutionsDiv.innerHTML = `
                <h4>ğŸ”§ Chromeç™½å±é—®é¢˜è§£å†³æ–¹æ¡ˆ:</h4>
                <div style="margin: 15px 0;">
                    <div class="status warning">
                        <strong>1. æ¸…é™¤Chromeç¼“å­˜å’ŒCookie</strong>
                    </div>
                    <p style="margin: 5px 0; font-size: 0.9rem;">
                        è®¾ç½® â†’ éšç§è®¾ç½®å’Œå®‰å…¨æ€§ â†’ æ¸…é™¤æµè§ˆæ•°æ® â†’ é€‰æ‹©"æ‰€æœ‰æ—¶é—´" â†’ å‹¾é€‰æ‰€æœ‰é€‰é¡¹ â†’ æ¸…é™¤æ•°æ®
                    </p>
                </div>
                
                <div style="margin: 15px 0;">
                    <div class="status warning">
                        <strong>2. ç¦ç”¨Chromeæ‰©å±•</strong>
                    </div>
                    <p style="margin: 5px 0; font-size: 0.9rem;">
                        è®¾ç½® â†’ æ‰©å±•ç¨‹åº â†’ ä¸´æ—¶ç¦ç”¨æ‰€æœ‰æ‰©å±• â†’ åˆ·æ–°é¡µé¢æµ‹è¯•
                    </p>
                </div>
                
                <div style="margin: 15px 0;">
                    <div class="status warning">
                        <strong>3. æ£€æŸ¥Chromeè®¾ç½®</strong>
                    </div>
                    <p style="margin: 5px 0; font-size: 0.9rem;">
                        è®¾ç½® â†’ é«˜çº§ â†’ ç³»ç»Ÿ â†’ å…³é—­"ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿ" â†’ é‡å¯Chrome
                    </p>
                </div>
                
                <div style="margin: 15px 0;">
                    <div class="status warning">
                        <strong>4. æ›´æ–°Chromeç‰ˆæœ¬</strong>
                    </div>
                    <p style="margin: 5px 0; font-size: 0.9rem;">
                        è®¾ç½® â†’ å…³äºChrome â†’ æ£€æŸ¥æ›´æ–° â†’ é‡å¯Chrome
                    </p>
                </div>
                
                <div style="margin: 15px 0;">
                    <div class="status info">
                        <strong>5. å¯¹æ¯”æµ‹è¯•</strong>
                    </div>
                    <p style="margin: 5px 0; font-size: 0.9rem;">
                        åœ¨Safariä¸­æ­£å¸¸æ‰“å¼€ï¼Œè¯´æ˜ç½‘ç«™æœ¬èº«æ²¡é—®é¢˜ï¼Œé—®é¢˜å‡ºåœ¨Chromeç‰¹å®šç¯å¢ƒ
                    </p>
                </div>
            `;
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        window.addEventListener('load', function() {
            logChrome('ğŸš€ Chromeè¯Šæ–­é¡µé¢åŠ è½½å®Œæˆ');
            detectChromeInfo();
            detectChromeFeatures();
            compareBrowsers();
            showChromeSolutions();
            
            // è‡ªåŠ¨è¿è¡ŒåŸºç¡€è¯Šæ–­
            setTimeout(() => {
                logChrome('â° è‡ªåŠ¨è¿è¡ŒåŸºç¡€è¯Šæ–­...');
                testReactInChrome();
                testModuleLoading();
                testES6Features();
                detectChromeExtensions();
            }, 1000);
        });

        // é”™è¯¯ç›‘å¬
        window.addEventListener('error', function(event) {
            logChrome(`ğŸš¨ é¡µé¢é”™è¯¯: ${event.message}`, 'error');
        });

        window.addEventListener('unhandledrejection', function(event) {
            logChrome(`ğŸš¨ æœªå¤„ç†çš„Promiseæ‹’ç»: ${event.reason}`, 'error');
        });

        logChrome('ğŸ”§ Chromeè¯Šæ–­é¡µé¢åˆå§‹åŒ–å®Œæˆ');
    </script>
</body>
</html>
