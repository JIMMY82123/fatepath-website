<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- Favicon and App Icons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="/android-chrome-512x512.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- SEO and Search Engine Icons -->
    <meta name="msapplication-TileColor" content="#facc15" />
    <meta name="msapplication-TileImage" content="/android-chrome-192x192.svg" />
    <meta name="msapplication-config" content="/browserconfig.xml" />
    
    <title>FatePath - Professional BaZi Reading Service | Free Bazi Chart Analysis | Chinese Numerology Expert</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#facc15" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="FatePath" />
    <link rel="apple-touch-icon" href="/images/icons/icon-192x192.png" />
    <link rel="manifest" href="/manifest.json" />
    <meta name="description" content="FatePath - Get your free BaZi chart analysis today! Professional Chinese numerology expert with 15+ years experience. BaZi reading for career guidance, love compatibility, wealth analysis. Online consultation worldwide." />
    <meta name="keywords" content="fatepath, bazi reading, free bazi chart analysis, chinese numerology expert, bazi career guidance, bazi love compatibility, bazi wealth analysis, online bazi consultation, bazi master consultation, traditional chinese numerology, bazi chart calculator, bazi relationship reading, bazi life path analysis" />
    <meta name="author" content="FatePath" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://fatepath.me/" />
    <meta property="og:title" content="FatePath - Professional BaZi Reading Service | Free Bazi Chart Analysis" />
    <meta property="og:description" content="FatePath - Get your free BaZi chart analysis today! Professional Chinese numerology expert with 15+ years experience. BaZi reading for career guidance, love compatibility, wealth analysis." />
    <meta property="og:image" content="https://fatepath.me/og-image.svg" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://fatepath.me/" />
    <meta property="twitter:title" content="FatePath - Professional BaZi Reading Service | Free Bazi Chart Analysis" />
    <meta property="twitter:description" content="FatePath - Get your free BaZi chart analysis today! Professional Chinese numerology expert with 15+ years experience. BaZi reading for career guidance, love compatibility, wealth analysis." />
    <meta property="twitter:image" content="https://fatepath.me/og-image.svg" />

    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    
    <!-- Fonts with display=swap for better performance -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700;800&family=Cinzel:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="/favicon.svg" as="image" type="image/svg+xml">
    
    <!-- Google Analytics - 延迟加载以避免阻塞移动端渲染 -->
    <script>
      // 延迟加载 Google Analytics
      setTimeout(() => {
        const script = document.createElement('script');
        script.src = 'https://www.googletagmanager.com/gtag/js?id=G-GCNP2F5NJC';
        script.async = true;
        script.onload = function() {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-GCNP2F5NJC', {
            'page_title': document.title,
            'page_location': window.location.href,
            'allow_google_signals': false,
            'allow_ad_personalization_signals': false,
            'anonymize_ip': true
          });
          
          // 开发环境调试
          if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
            console.log('🔍 Google Analytics 已加载（开发模式）');
          }
        };
        document.head.appendChild(script);
      }, 2000); // 延迟2秒加载
    </script>
    
    <!-- Google Tag Manager - 延迟加载 -->
    <script>
      // 延迟加载 Google Tag Manager
      setTimeout(() => {
        const script = document.createElement('script');
        script.innerHTML = `
          (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
          j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
          'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
          })(window,document,'script','dataLayer','GTM-5623V8HV');
        `;
        document.head.appendChild(script);
      }, 3000); // 延迟3秒加载
    </script>
    <!-- End Google Tag Manager -->
    
    <!-- Google Ads Global Site Tag - 延迟加载 -->
    <script>
      // 延迟加载 Google Ads
      setTimeout(() => {
        const script = document.createElement('script');
        script.src = 'https://www.googletagmanager.com/gtag/js?id=AW-17430671654';
        script.async = true;
        script.onload = function() {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'AW-17430671654');
          
          // Google Ads 转化跟踪配置
          gtag('config', 'AW-17430671654', {
            'conversion_id': 'AW-17430671654',
            'conversion_label': 'e2eYCNWo1P4aEKbiy_dA'
          });
          
          // 开发环境调试
          if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
            console.log('🔍 Google Ads 已加载（开发模式）');
            console.log('🎯 转化ID: AW-17430671654');
            console.log('🏷️ 转化标签: e2eYCNWo1P4aEKbiy_dA');
          }
        };
        document.head.appendChild(script);
      }, 4000); // 延迟4秒加载
    </script>
    
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ProfessionalService",
      "name": "FatePath",
      "alternateName": "Mystic Wisdom, FatePath BaZi Reading",
      "description": "FatePath - Professional BaZi reading, love compatibility analysis, and custom talismans based on ancient Chinese numerology and astrology.",
      "url": "https://fatepath.me",
      "logo": "https://fatepath.me/favicon.svg",
      "image": "https://fatepath.me/og-image.svg",
      "telephone": "+86-15914228258",
      "email": "chenxiao0801@hotmail.com",
             "address": {
         "@type": "PostalAddress",
         "addressCountry": "US"
       },
      "serviceType": ["BaZi Reading", "Chinese Numerology", "Love Compatibility Analysis", "Custom Talisman", "Spiritual Guidance"],
      "areaServed": "Worldwide",
      "priceRange": "$$",
      "currenciesAccepted": "USD, CNY",
      "paymentAccepted": "PayPal",
      "openingHours": "Mo-Su 09:00-21:00",
      "hasOfferCatalog": {
        "@type": "OfferCatalog",
        "name": "Mystic Services",
        "itemListElement": [
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Detailed Bazi Reading",
              "description": "Comprehensive life path analysis through Bazi (八字) analysis including personality, career, and life purpose"
            },
            "price": "38",
            "priceCurrency": "USD",
            "availability": "https://schema.org/InStock"
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Love Compatibility Reading",
              "description": "Relationship and partnership analysis through Bazi compatibility and Five Elements theory"
            },
            "price": "44",
            "priceCurrency": "USD",
            "availability": "https://schema.org/InStock"
          },
          {
            "@type": "Offer",
            "itemOffered": {
              "@type": "Service",
              "name": "Custom Talisman",
              "description": "Personalized protection talisman crafted specifically for your unique birth chart"
            },
            "price": "129",
            "priceCurrency": "USD",
            "availability": "https://schema.org/InStock"
          }
        ]
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "5.0",
        "reviewCount": "50",
        "bestRating": "5",
        "worstRating": "1"
      },
      "review": [
        {
          "@type": "Review",
          "reviewRating": {
            "@type": "Rating",
            "ratingValue": "5",
            "bestRating": "5"
          },
          "author": {
            "@type": "Person",
            "name": "Sarah Johnson"
          },
          "reviewBody": "The BaZi report was incredibly accurate and helped me understand my career path better."
        }
      ]
    }
    </script>


  </head>
  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
      <iframe 
        src="https://www.googletagmanager.com/ns.html?id=GTM-5623V8HV"
        height="0" 
        width="0" 
        style="display:none;visibility:hidden">
      </iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->
    
    <div id="root"></div>
    
    <!-- 谷歌广告直接访问修复脚本 - 增强版 -->
    <script>
      // 立即执行的修复脚本，解决谷歌广告直接访问白屏问题
      (function() {
        console.log('🔧 启动增强版谷歌广告白屏修复脚本...');
        
        // 立即阻止默认的React应用加载
        const originalScript = document.querySelector('script[src="/src/main.jsx"]');
        if (originalScript) {
          originalScript.remove();
          console.log('🗑️ 已移除原始React应用脚本');
        }
        
        // 检测访问来源
        function isDirectAccess() {
          const referrer = document.referrer;
          const isDirect = !referrer || 
                           referrer.includes('google.com') || 
                           referrer.includes('googleadservices.com') ||
                           referrer.includes('doubleclick.net') ||
                           referrer.includes('googlesyndication.com') ||
                           referrer.includes('bing.com') ||
                           referrer.includes('facebook.com') ||
                           referrer.includes('twitter.com') ||
                           referrer.includes('youtube.com') ||
                           referrer.includes('instagram.com');
          
          console.log('🔍 访问来源检测:', { referrer, isDirect, url: window.location.href });
          return isDirect;
        }
        
        // 显示加载指示器
        function showLoadingIndicator() {
          const root = document.getElementById('root');
          if (root) {
            root.innerHTML = `
              <div style="
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: #1a1a1a;
                color: white;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                z-index: 9999;
                font-family: Arial, sans-serif;
              ">
                <div style="text-align: center; max-width: 400px; padding: 20px;">
                  <h2 style="color: #fbbf24; margin-bottom: 16px;">正在加载最佳体验...</h2>
                  <p style="margin-bottom: 20px;">检测到外部访问，正在优化页面加载...</p>
                  <div style="
                    width: 40px;
                    height: 40px;
                    border: 4px solid #333;
                    border-top: 4px solid #fbbf24;
                    border-radius: 50%;
                    animation: spin 1s linear infinite;
                    margin: 0 auto 20px;
                  "></div>
                  <p style="font-size: 14px; color: #888;">请稍候，正在为您准备最佳版本...</p>
                  <div style="margin-top: 20px;">
                    <button onclick="window.location.reload()" style="
                      background: #fbbf24;
                      color: #1a1a1a;
                      border: none;
                      padding: 10px 20px;
                      border-radius: 6px;
                      font-weight: 600;
                      cursor: pointer;
                      margin: 0 10px;
                    ">刷新页面</button>
                    <button onclick="forceLoadApp()" style="
                      background: #10b981;
                      color: white;
                      border: none;
                      padding: 10px 20px;
                      border-radius: 6px;
                      font-weight: 600;
                      cursor: pointer;
                      margin: 0 10px;
                    ">强制加载</button>
                  </div>
                </div>
              </div>
              <style>
                @keyframes spin {
                  0% { transform: rotate(0deg); }
                  100% { transform: rotate(360deg); }
                }
              </style>
            `;
          }
        }
        
        // 强制加载应用
        function forceLoadApp() {
          console.log('🚀 强制加载React应用...');
          
          // 清除加载指示器
          const root = document.getElementById('root');
          if (root) {
            root.innerHTML = '';
          }
          
          // 创建新的脚本标签
          const script = document.createElement('script');
          script.type = 'module';
          script.src = '/src/main.jsx';
          script.onload = function() {
            console.log('✅ React应用加载成功');
          };
          script.onerror = function() {
            console.error('❌ React应用加载失败，尝试备用方案...');
            // 备用方案：直接跳转到主页
            setTimeout(() => {
              window.location.href = '/';
            }, 1000);
          };
          
          document.body.appendChild(script);
        }
        
        // 延迟加载策略
        function delayedLoadApp() {
          console.log('⏰ 延迟加载React应用...');
          
          // 等待一段时间后加载应用
          setTimeout(() => {
            forceLoadApp();
          }, 2000);
        }
        
        // 主修复逻辑
        function applyFix() {
          console.log('🎯 应用增强版修复策略...');
          
          // 1. 立即显示加载指示器
          showLoadingIndicator();
          
          // 2. 延迟加载应用
          delayedLoadApp();
          
          // 3. 设置备用检查
          setTimeout(() => {
            const root = document.getElementById('root');
            if (root && root.children.length === 0) {
              console.warn('⚠️ 页面仍然为空，应用备用修复...');
              forceLoadApp();
            }
          }, 8000);
        }
        
        // 执行修复逻辑
        if (isDirectAccess()) {
          console.log('🎯 检测到直接访问，立即应用增强版修复...');
          applyFix();
        } else {
          console.log('ℹ️ 非直接访问，但应用预防性修复...');
          // 即使不是直接访问，也应用预防性修复
          setTimeout(() => {
            const root = document.getElementById('root');
            if (root && root.children.length === 0) {
              console.log('⚠️ 检测到页面异常，应用修复...');
              applyFix();
            }
          }, 3000);
        }
        
        // 全局错误处理
        window.addEventListener('error', function(event) {
          console.error('🚨 全局错误:', event.error);
          console.log('🔄 尝试自动修复...');
          setTimeout(forceLoadApp, 1000);
        });
        
        // 未处理的Promise拒绝
        window.addEventListener('unhandledrejection', function(event) {
          console.error('🚨 未处理的Promise拒绝:', event.reason);
          event.preventDefault();
          setTimeout(forceLoadApp, 1000);
        });
        
        // 页面可见性变化处理
        document.addEventListener('visibilitychange', function() {
          if (document.visibilityState === 'visible') {
            console.log('👁️ 页面重新可见，检查状态...');
            setTimeout(() => {
              const root = document.getElementById('root');
              if (root && root.children.length === 0) {
                console.log('⚠️ 页面重新可见但内容为空，应用修复...');
                applyFix();
              }
            }, 1000);
          }
        });
        
        // 导出修复函数供外部使用
        window.forceLoadApp = forceLoadApp;
        
        console.log('✅ 增强版修复脚本初始化完成');
        
      })();
    </script>
    
    <!-- 主应用脚本 -->
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html> 